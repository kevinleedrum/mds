import{r as t,h as s,H as i,g as e,c as h}from"./p-f1ddf482.js";import{R as n}from"./p-defc2565.js";import{M as a,m as o}from"./p-8a252c56.js";import{d as r,e as l,a as c,g as d,f as u}from"./p-f5db2eb6.js";import{c as m,e as w}from"./p-ea9c9d56.js";const p=class{constructor(s){t(this,s),this.value=null,this.simulateProgressDuration=null,this.appearDelay=0}simulateProgress(){clearInterval(this.simulateProgressInterval),this.simulateProgressDuration&&(this.simulateProgressInterval=setInterval((()=>{100!==this.value&&(this.value=Math.min((this.value||0)+1,99))}),this.simulateProgressDuration/100))}connectedCallback(){this.simulateProgress(),this.appearDelay&&(this.element.classList.remove("block"),this.element.classList.add("hidden"),this.delayTimeout=setTimeout((()=>{this.element.classList.remove("hidden"),this.element.classList.add("block")}),this.appearDelay))}disconnectedCallback(){clearTimeout(this.delayTimeout)}get determinateBarStyle(){return{transform:`translateX(${this.value-100}%)`,transition:"transform 0.4s linear"}}render(){return s(i,{class:"mx-linear-progress block h-4 w-full rounded-sm overflow-hidden pointer-events-none",role:"progressbar","aria-valuenow":null!=this.value?Math.round(this.value):null,"aria-valuemin":null!=this.value?0:null,"aria-valuemax":null!=this.value?100:null},s("div",{class:"relative h-full"},null!=this.value?s("div",{"data-testid":"determinate",class:"fill h-4 absolute inset-0 rounded-sm",style:this.determinateBarStyle}):[s("div",{"data-testid":"indeterminate1",class:"indeterminate1 absolute h-full w-full"},s("div",{class:"fill absolute w-full h-full rounded-sm"})),s("div",{"data-testid":"indeterminate2",class:"indeterminate2 absolute h-full w-full"},s("div",{class:"fill absolute w-full h-full rounded-sm"}))]))}get element(){return e(this)}static get watchers(){return{simulateProgressDuration:["simulateProgress"]}}},g=class{constructor(s){t(this,s),this.mxPageChange=h(this,"mxPageChange",7),this.hasStatus=!1,this.page=1,this.rowsPerPageOptions=[10,25,50,100],this.rowsPerPage=100,this.simple=!1,this.disabled=!1,this.disableNextPage=!1,this.hideRowsPerPage=!1,this.moveStatusToBottom=!1,this.isXSmallMinWidth=!1,this.isSmallMinWidth=!1}componentWillRender(){this.hasStatus=!!this.element.querySelector('[slot="status"]')}componentDidLoad(){this.rowsMenu&&this.rowsMenuAnchor&&(this.rowsMenu.anchorEl=this.rowsMenuAnchor),this.resizeObserver=new n((()=>this.updateResponsiveElements())),this.resizeObserver.observe(this.element),requestAnimationFrame(this.updateResponsiveElements.bind(this))}updateResponsiveElements(){if(!this.paginationWrapper)return;let t=Array.from(this.paginationWrapper.children).reduce(((t,s)=>t+s.scrollWidth),0);this.hideRowsPerPage&&this.rowsPerPageWrapper&&(t+=this.rowsPerPageWrapper.scrollWidth);const s=t-this.element.offsetWidth;this.hideRowsPerPage=s>0,this.moveStatusToBottom=s>this.rowsPerPageWrapper.scrollWidth,this.isXSmallMinWidth=this.element.offsetWidth>=320,this.isSmallMinWidth=this.element.offsetWidth>=640}get isPreviousPageDisabled(){return 1===this.page||this.disabled}get isNextPageDisabled(){return this.page===this.lastPage||this.disabled||this.disableNextPage}get isLastPageDisabled(){return this.page===this.lastPage||this.disabled}onClickFirstPage(){this.isPreviousPageDisabled||this.mxPageChange.emit({page:1,rowsPerPage:this.rowsPerPage})}onClickPreviousPage(){this.isPreviousPageDisabled||this.mxPageChange.emit({page:this.page-1,rowsPerPage:this.rowsPerPage})}onClickNextPage(){this.isNextPageDisabled||this.mxPageChange.emit({page:this.page+1,rowsPerPage:this.rowsPerPage})}onClickLastPage(){this.isLastPageDisabled||this.mxPageChange.emit({page:this.lastPage,rowsPerPage:this.rowsPerPage})}onChangeRowsPerPage(t){this.mxPageChange.emit({page:1,rowsPerPage:t})}get lastPage(){return 0===this.totalRows?1:null==this.totalRows?null:Math.ceil(this.totalRows/this.rowsPerPage)}get currentRange(){const t=this.rowsPerPage*(this.page-1)+1;return t+"–"+Math.min(this.totalRows,t+this.rowsPerPage-1)}get rowRangeClass(){let t="text-center flex-shrink min-w-0";return t+=this.isSmallMinWidth?" px-24":" px-16",this.isXSmallMinWidth||(t+=" whitespace-normal"),t}get paginationWrapperClass(){let t="flex relative";return this.moveStatusToBottom?t+=" flex-col-reverse items-end":(t+=" items-center",t+=this.hasStatus?" justify-between":" justify-end"),t}render(){return s(i,{class:"mx-pagination relative block text-4 whitespace-nowrap select-none"},!this.simple&&s("div",{class:"pagination-bg absolute top-0 left-0 w-full h-56 rounded-b-2xl"}),this.simple?s("div",{class:"simple flex items-center justify-center h-48"},s("mx-icon-button",{"el-aria-label":"Previous page","chevron-left":!0,disabled:1===this.page||this.disabled,onClick:this.onClickPreviousPage.bind(this)}),null!==this.lastPage?this.page+" of "+this.lastPage:"",s("mx-icon-button",{"el-aria-label":"Next page","chevron-right":!0,disabled:this.page===this.lastPage||this.disabled||this.disableNextPage,onClick:this.onClickNextPage.bind(this)})):s("div",{ref:t=>this.paginationWrapper=t,class:this.paginationWrapperClass},this.hasStatus&&s("div",{"data-testid":"status",class:"px-24 py-10 flex relative items-center justify-self-start"},s("slot",{name:"status"})),s("div",{class:"flex flex-grow-0 items-center justify-end h-56 pr-4"+(this.hideRowsPerPage?" relative":"")},this.rowsPerPageOptions&&this.rowsPerPageOptions.length>1&&s("div",{ref:t=>this.rowsPerPageWrapper=t,"aria-hidden":this.hideRowsPerPage,class:"flex items-center px-24"+(this.hideRowsPerPage?" absolute opacity-0 pointer-events-none":"")},"Rows per page:  ",s("div",{"data-testid":"rows-per-page",ref:t=>this.rowsMenuAnchor=t,class:"flex items-center cursor-pointer"},this.rowsPerPage,s("i",{class:"mds-arrow-triangle-down ml-12 text-icon"})),s("mx-menu",{ref:t=>this.rowsMenu=t,onMxClose:t=>t.stopPropagation()},this.rowsPerPageOptions.map((t=>s("mx-menu-item",{disabled:this.disabled,onClick:this.onChangeRowsPerPage.bind(this,t)},t))))),this.totalRows>0&&s("div",{"data-testid":"row-range",class:this.rowRangeClass},this.currentRange," of ",this.totalRows),s("div",{class:"flex items-center sm:space-x-8"},s("mx-icon-button",{"el-aria-label":"First page",icon:"mds-page-first",disabled:this.isPreviousPageDisabled,onClick:this.onClickFirstPage.bind(this)}),s("mx-icon-button",{"el-aria-label":"Previous page",icon:"mds-chevron-left",disabled:this.isPreviousPageDisabled,onClick:this.onClickPreviousPage.bind(this)}),s("mx-icon-button",{"el-aria-label":"Next page",icon:"mds-chevron-right",disabled:this.isNextPageDisabled,onClick:this.onClickNextPage.bind(this)}),null!==this.lastPage&&s("mx-icon-button",{"el-aria-label":"Last page",icon:"mds-page-last",disabled:this.isLastPageDisabled,onClick:this.onClickLastPage.bind(this)})))))}get element(){return e(this)}},f=class{constructor(s){t(this,s),this.isExposedMobileColumn=!0,this.minWidths=new a}connectedCallback(){o.subscribeComponent(this)}disconnectedCallback(){o.unsubscribeComponent(this)}get cellClass(){let t="mx-table-cell flex flex-1 items-center overflow-hidden";return!this.minWidths.sm&&this.isExposedMobileColumn?t+=" row-start-1 exposed-cell":this.minWidths.sm||(t+=" col-start-2 col-span-4"),t}render(){return s(i,{role:"gridcell","aria-describedby":null!=this.columnIndex?`column-header-${this.columnIndex}`:null,class:this.cellClass},s("div",{class:this.isExposedMobileColumn||this.minWidths.sm?"overflow-hidden":"py-0 pb-12"},s("div",{class:"min-h-16 max-w-full overflow-hidden overflow-ellipsis whitespace-normal",role:null==this.columnIndex?"heading":null,"aria-level":null==this.columnIndex?"1":null},!this.minWidths.sm&&!this.isExposedMobileColumn&&null!=this.heading&&s("p",{class:"subtitle5 my-0 mb-4",innerHTML:this.heading}),s("slot",null))))}get element(){return e(this)}};class b{constructor(t){this.scrollingContainer=r(t)}update(t){clearInterval(this.interval);const{clientX:s,clientY:i}=c(t),e=l(this.scrollingContainer);i>=e.top&&i<=e.bottom&&s>=e.left&&s<=e.right||(this.interval=setInterval(window.scrollBy,5,5*(s<e.left?-1:1),5*(i<e.top?-1:1)))}stop(){clearInterval(this.interval)}}let x;const v=class{constructor(s){t(this,s),this.mxCheck=h(this,"mxCheck",7),this.mxRowDragStart=h(this,"mxRowDragStart",7),this.mxRowDragEnd=h(this,"mxRowDragEnd",7),this.mxDragKeyDown=h(this,"mxDragKeyDown",7),this.mxRowAccordion=h(this,"mxRowAccordion",7),this.dragOrigin={x:0,y:0},this.indentLevel=0,this.columnCount=1,this.isHidden=!1,this.actions=[],this.doNotCollapse=!1,this.doNotDrag=!1,this.checked=!1,this.collapseNestedRows=!1,this.subheader=!1,this.minWidths=new a,this.checkable=!1,this.checkOnRowClick=!1,this.isDraggable=!1,this.isDragging=!1,this.isMobileExpanded=!1,this.isMobileCollapsing=!1}onCollapseNestedRowsChange(){this.toggleNestedRows()}async onMinWidthsChange(){this.collapseNestedRows&&(await new Promise(requestAnimationFrame),this.toggleNestedRows(!0))}async translateRow(t,s){const i=`translate3d(${t}px, ${s}px, 0)`;this.dragShadowEl&&(this.dragShadowEl.style.transform=i),(await this.getChildren()).forEach((t=>t.style.transform=i))}async toggle(t,s){this.isHidden=t;const i=await this.getChildren(),e=this.isHidden?m:w;await Promise.all(i.map((t=>e(t,s?0:void 0)))),i.forEach((t=>t.style.border=this.isHidden?"0":"")),this.element.setAttribute("aria-hidden",this.isHidden?"true":"false")}connectedCallback(){if(o.subscribeComponent(this),this.actions.some((t=>!t.value)))throw new Error("Table row actions must have a value property!");this.setIndentLevel()}componentDidLoad(){this.collapseNestedRows&&this.toggleNestedRows(!0)}componentWillRender(){const t=this.element.closest("mx-table");if(this.checkable=t&&t.checkable,this.isDraggable=t&&t.draggableRows&&!this.doNotDrag,this.columnCount=(t&&t.columns.length)+(this.actions.length?1:0),this.checkable&&null==this.rowId)throw new Error("Checkable rows require either a getRowId prop on the table, or a rowId on the row!");this.checkable&&(this.checkOnRowClick=t.checkOnRowClick)}componentDidRender(){this.actions.length>1&&this.actionMenu&&this.actionMenuButton&&(this.actionMenu.anchorEl=this.actionMenuButton),this.wrapFirstColumn(),this.moveNestedRows(),this.resetResizeObserver()}setCollapsedHeight(){this.minWidths.sm||this.isMobileExpanded||this.isHidden||(this.rowEl.style.maxHeight=this.getCollapsedHeight())}disconnectedCallback(){o.unsubscribeComponent(this)}async resetResizeObserver(){this.resizeObserver&&this.resizeObserver.disconnect(),this.minWidths.sm||(this.resizeObserver=new n((()=>this.setCollapsedHeight())),this.resizeObserver.observe(this.element.firstElementChild))}setIndentLevel(){let t=this.element.parentElement.closest("mx-table-row");for(this.indentLevel=0;t;)t.subheader||this.indentLevel++,t=t.parentElement.closest("mx-table-row")}toggleNestedRows(t=!1){Array.from(this.childRowWrapper.children).filter((t=>!t.doNotCollapse)).forEach((async s=>{s.toggle(this.collapseNestedRows,t)})),clearTimeout(x),x=setTimeout(this.mxRowAccordion.emit,200)}wrapFirstColumn(){if(this.firstCellTarget&&this.firstCellTarget.parentNode){const t=this.element.querySelector("mx-table-cell");t&&this.firstCellTarget.parentNode.replaceChild(t,this.firstCellTarget)}}moveNestedRows(){Array.from(this.rowEl.children).filter((t=>"MX-TABLE-ROW"===t.tagName)).forEach((t=>this.childRowWrapper.appendChild(t)))}onClick(t){if(!t.target.closest("a, button, input, mx-menu"))if(this.minWidths.sm)this.checkable&&this.checkOnRowClick&&(this.checked=!this.checked,this.mxCheck.emit({rowId:this.rowId,checked:this.checked}));else{const s=this.getExposedCell();if(!s||this.subheader||this.columnCount<2)return;t.target.closest("mx-table-cell")===s&&this.accordion()}}onMouseOver(t){t.stopPropagation(),t.buttons>0||this.rowEl.classList.add("hovered-row")}onMouseOut(t){t.stopPropagation(),this.rowEl.classList.remove("hovered-row")}onKeyboardHandleKeyDown(t){!this.isDragging&&[" ","Enter"].includes(t.key)&&this.startDragging(t)}async startDragging(t){if(t.stopPropagation(),t.preventDefault(),this.isDragging=!0,"keydown"!==t.type){const{pageX:s,pageY:i}=c(t);this.dragOrigin.x=s,this.dragOrigin.y=i}else{const{top:t,left:s}=d(this.rowEl.children[0]);this.dragOrigin.x=s,this.dragOrigin.y=t}this.rowEl.classList.add("pointer-events-none"),this.createDragShadowEl();const s=await this.getChildren();for(let t=0;t<s.length;t++)s[t].style.zIndex="9999";this.addDragListeners(t),this.mxRowDragStart.emit({isKeyboard:"keydown"===t.type})}addDragListeners(t){const s=t=>{requestAnimationFrame((()=>{if(!this.isDragging)return;const{pageX:s,pageY:i}=c(t);this.translateRow(s-this.dragOrigin.x,i-this.dragOrigin.y),this.dragScroller&&this.dragScroller.update(t)}))},i=t=>{t.stopPropagation(),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",i),document.removeEventListener("touchcancel",i),this.dragScroller.stop(),this.dragScroller=null,this.stopDragging("touchcancel"===t.type)},e=t=>{if([" ","Enter"].includes(t.key))document.removeEventListener("keydown",e),this.stopDragging(!0);else if(["Escape","Tab"].includes(t.key))document.removeEventListener("keydown",e),this.stopDragging(!0,!0);else{if(!t.key.includes("Arrow"))return;this.mxDragKeyDown.emit(t.key)}t.stopPropagation(),t.preventDefault()};"keydown"===t.type?document.addEventListener("keydown",e):"touchstart"===t.type?(this.dragScroller=new b(this.rowEl),document.addEventListener("touchmove",s),document.addEventListener("touchend",i),document.addEventListener("touchcancel",i)):(this.dragScroller=new b(this.rowEl),document.addEventListener("mousemove",s),document.addEventListener("mouseup",i))}async stopDragging(t=!1,s=!1){this.isDragging=!1,this.rowEl.classList.remove("drag-row","pointer-events-none"),this.dragShadowEl&&this.dragShadowEl.remove(),this.dragShadowEl=void 0;const i=await this.getChildren();for(let t=0;t<i.length;t++){const s=i[t];s.style.transform="",s.style.zIndex=""}this.mxRowDragEnd.emit({isKeyboard:t,isCancel:s})}async createDragShadowEl(){this.dragShadowEl=document.createElement("div"),this.dragShadowEl.classList.add("absolute","w-full","shadow-24"),this.dragShadowEl.style.zIndex="9998",this.dragShadowEl.style.height=await this.getHeight()+"px";const t=(await this.getChildren())[0];this.dragShadowEl.style.top=t.offsetTop+"px",this.dragShadowEl.style.left=t.offsetLeft+"px",this.element.parentNode.insertBefore(this.dragShadowEl,this.element)}accordion(){this.minWidths.sm||(this.isMobileExpanded?this.collapse():this.expand())}async collapse(t=!1){this.isMobileExpanded&&(this.isMobileCollapsing=!0,t||await m(this.rowEl,150,this.getCollapsedHeight()),this.isMobileExpanded=!1,this.isMobileCollapsing=!1)}async expand(){this.isMobileExpanded||(this.isMobileExpanded=!0,await new Promise(requestAnimationFrame),w(this.rowEl))}async focusDragHandle(){this.keyboardDragHandle&&this.keyboardDragHandle.focus()}async getChildren(){const t=[];if(this.minWidths.sm?Array.from(this.rowEl.children).forEach((s=>{s.offsetParent?t.push(s):t.push(...Array.from(s.children))})):t.push(this.rowEl),!this.collapseNestedRows){const s=Array.from(this.childRowWrapper.children);await Promise.all(s.map((s=>s.getChildren().then((s=>t.push(...s))))))}return t}async getNestedRowIndexes(){return Array.from(this.childRowWrapper.children).map((t=>t.rowIndex)).filter((t=>null!=t))}async getHeight(){let t=(await this.getChildren())[0].offsetHeight;const s=Array.from(this.childRowWrapper.children);return await Promise.all(s.map((s=>s.getHeight().then((s=>t+=s))))),t}onTransitionEnd(t){t.target===this.rowEl.children[0]&&u(this.rowEl.children[0])&&this.rowEl.children[0].scrollIntoView()}onCheckboxInput(t){this.mxCheck.emit({rowId:this.rowId,checked:t.target.checked})}getExposedCell(){return(Array.from(this.element.querySelectorAll("mx-table-cell"))||[]).find((t=>t.isExposedMobileColumn))}getCollapsedHeight(){const t=this.getExposedCell();return t&&t.offsetHeight?t.offsetHeight+1+"px":"calc(3.25rem + 1px)"}get rowEl(){return this.element.firstElementChild}get rowClass(){let t="table-row";return t+=this.minWidths.sm?" contents":" grid overflow-hidden",this.checkable&&(t+=" checkable-row"),this.checkable&&this.checkOnRowClick&&(t+=" cursor-pointer"),this.minWidths.sm||this.isMobileExpanded||(t+=" mobile-collapsed"),this.subheader&&(t+=" subheader overline2"),t}get rowStyle(){if(this.minWidths.sm)return{};let t=this.indentLevel>0?"minmax(0, min-content)":"0";return t+=this.checkable?" minmax(0, min-content)":" 0",t+=this.isDraggable?" minmax(0, min-content)":" 0",t+=" minmax(0, auto) minmax(0, min-content)",{gridTemplateColumns:t,maxHeight:""}}get indentClass(){let t="table-row-indent sm:h-full";return this.minWidths.sm?t:(t+=" col-start-1 row-start-1",t+" row-span-"+this.columnCount)}get indentStyle(){return{width:2*this.indentLevel+"rem",minWidth:this.indentLevel+"rem"}}render(){return s(i,{class:"mx-table-row contents"},s("div",{role:"row",class:this.rowClass,style:this.rowStyle,onClick:this.onClick.bind(this),onTransitionEnd:this.onTransitionEnd.bind(this),onMouseOver:this.onMouseOver.bind(this),onMouseOut:this.onMouseOut.bind(this)},s("div",{class:"first-column-wrapper contents sm:flex sm:items-center min-w-0 overflow-hidden"+(this.subheader?" sm:col-span-full pr-0":"")},s("div",{class:this.indentClass,style:this.indentStyle,"data-testid":"indent-"+this.indentLevel}),this.checkable&&s("div",{class:"flex items-center pr-4 col-start-2 row-start-1 sm:row-start-auto sm:col-start-auto",onClick:this.accordion.bind(this)},s("mx-checkbox",{ref:t=>this.checkbox=t,checked:this.checked,onInput:this.onCheckboxInput.bind(this),onClick:t=>t.stopPropagation(),"label-name":"Select row","hide-label":!0})),this.isDraggable&&s("div",{class:"drag-handle flex items-center col-start-3 row-start-1 sm:row-start-auto sm:col-start-auto cursor-move","data-testid":"drag-handle",onMouseDown:this.startDragging.bind(this),onTouchStart:this.startDragging.bind(this)},s("i",{"aria-label":"Press Space or Enter to move this row",ref:t=>this.keyboardDragHandle=t,role:"button",tabindex:"0",class:"mds-drag-dots text-icon pointer-events-none"+(this.checkable?" mx-8":""),onKeyDown:this.onKeyboardHandleKeyDown.bind(this)}),this.isDragging&&s("p",{class:"sr-only",role:"alert"},"Use the arrow keys to move the row up and down. Press Space or Enter to accept. Press Escape to cancel.")),s("div",{ref:t=>this.firstCellTarget=t,class:"contents"}),this.subheader&&s("button",{type:"button",class:"flex border-0 items-center h-40 justify-end px-12","aria-label":"Toggle visibility of rows grouped under this one",onClick:()=>this.collapseNestedRows=!this.collapseNestedRows,onMouseDown:t=>t.preventDefault()},s("i",{class:"subheader-chevron mds-chevron-down text-icon transform"+(this.collapseNestedRows?"":" rotate-180")}))),s("slot",null),!this.checkable&&!this.minWidths.sm&&s("div",{class:"row-start-1 col-start-2 w-0"}),!this.isDraggable&&!this.minWidths.sm&&s("div",{class:"row-start-1 col-start-3 w-0"}),!this.minWidths.sm&&!this.subheader&&this.columnCount>1&&s("button",{type:"button",class:"flex border-0 items-center justify-end px-12 row-start-1","aria-label":"Toggle visibility of more column data",onClick:this.accordion.bind(this),onMouseDown:t=>t.preventDefault()},s("i",{class:"mobile-row-chevron mds-chevron-down text-icon transform"+(this.isMobileExpanded&&!this.isMobileCollapsing?" rotate-180":"")})),1===this.actions.length&&s("div",{class:"action-cell flex items-center p-16 sm:p-0 justify-end col-start-2 col-span-4 sm:col-span-1"},s("mx-button",Object.assign({"data-testid":"action-button","btn-type":"text"},this.actions[0]),this.actions[0].value)),this.actions.length>1&&s("div",{class:"action-cell flex items-center p-0 justify-end col-start-2 col-span-4 sm:col-span-1"},s("mx-icon-button",{ref:t=>this.actionMenuButton=t,"el-aria-label":"Row Actions",icon:"mds-dots-vertical"}),s("mx-menu",{"data-testid":"action-menu",ref:t=>this.actionMenu=t,onMxClose:t=>t.stopPropagation()},this.actions.map((t=>s("mx-menu-item",Object.assign({},t),t.value)))))),s("div",{ref:t=>this.childRowWrapper=t,class:"contents"}))}get element(){return e(this)}static get watchers(){return{collapseNestedRows:["onCollapseNestedRowsChange"],minWidths:["onMinWidthsChange"]}}};export{p as mx_linear_progress,g as mx_pagination,f as mx_table_cell,v as mx_table_row}