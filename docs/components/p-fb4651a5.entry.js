import{r as t,h as s,H as i,g as e}from"./p-f1ddf482.js";import{u as h,p as n,b as l}from"./p-f5db2eb6.js";const o=[];for(let t=0;t<24;t++)o.push({hours:t,minutes:0}),o.push({hours:t,minutes:30});const r=class{constructor(s){t(this,s),this.dataAttributes={},this.isTimeInputSupported=!1,this.uuid=h(),this.dense=!1,this.disabled=!1,this.error=!1,this.floatLabel=!1,this.isFocused=!1,this.isInputDirty=!1,this.componentWillRender=n}onClick(t){t.stopPropagation(),this.menu.style.width=this.pickerWrapper.getBoundingClientRect().width+"px"}onValueChange(){this.normalizeValue(),this.updateInputValue()}componentWillLoad(){this.normalizeValue()}componentDidLoad(){this.menu.anchorEl=this.pickerWrapper,this.menu.triggerEl=this.menuButton,this.isTimeInputSupported="time"===this.inputElem.type,this.updateInputValue()}normalizeValue(){if(this.value&&/\d\d:\d\d:\d\d/.test(this.value)){let[t]=this.value.split(":");const[,s]=this.value.split(":");this.value.toUpperCase().includes("PM")&&(t=(Number(t)+12).toString()),1===t.length&&(t="0"+t),this.value=[t,s].join(":")}}onInput(t){this.isTimeInputSupported||(t.stopPropagation(),this.isFocused&&(this.isInputDirty=!0))}onBlur(){if(this.menu&&this.menu.isOpen||(this.isFocused=!1),!this.isTimeInputSupported&&this.isInputDirty){const t=l(this.inputElem.value);if(null===t)return void(this.error=!0);this.setValue(t),this.updateInputValue()}}onFocus(){this.isFocused=!0,this.error=!1,this.isInputDirty=!1}onClickLabel(){this.inputElem.focus()}onMenuClose(t){t.stopPropagation(),this.inputElem.contains(document.activeElement)||(this.isFocused=!1)}onMenuOpen(){this.isFocused=!0}setValue({hours:t,minutes:s}){this.disabled||(this.error=!1,this.value=("0"+t).slice(-2)+":"+("0"+s).slice(-2),this.updateInputValue(),this.inputElem.dispatchEvent(new Event("input",{cancelable:!0,bubbles:!0})))}updateInputValue(){if(this.inputElem)if(null!=this.value){if(this.inputElem.value=this.value,!this.isTimeInputSupported){this.inputElem.dispatchEvent(new Event("input",{cancelable:!0,bubbles:!0}));const[t,s]=this.value.split(":").map(Number);this.inputElem.value=this.getLocalizedTimeString({hours:t,minutes:s})}}else this.inputElem.value=""}getLocalizedTimeString({hours:t,minutes:s}){const i=new Date;return i.setHours(t,s),i.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}get labelClassNames(){let t="block";return this.floatLabel?(t+=" absolute mt-0 left-12 px-4",this.dense&&(t+=" dense text-4"),(this.isFocused||this.inputHasText)&&(t+=" floating"),this.isFocused&&(t+=" -ml-1")):t+=" subtitle2 mb-4 pointer-events-none",t}get inputHasText(){return this.value||this.inputElem&&this.inputElem.validity.badInput}get pickerWrapperClass(){let t="picker-wrapper w-152 flex items-center relative rounded-lg";return t+=this.dense?" h-36":" h-48",t+=this.error||this.isFocused?" border-2":" border",this.disabled&&(t+=" disabled"),this.isFocused&&(t+=" focused"),t}get inputClass(){let t="absolute inset-0 w-full h-full pl-12 overflow-hidden outline-none appearance-none select-none bg-transparent";return(this.isFocused||this.error)&&(t+=" -ml-1"),!this.floatLabel||this.isFocused||this.inputHasText||(t+=" opacity-0"),t}get menuButtonClass(){let t="menu-button text-icon cursor-pointer border-0 absolute flex items-center h-full right-12 space-x-8";return this.disabled&&(t+=" pointer-events-none"),(this.isFocused||this.error)&&(t+=" -mr-1"),t}render(){const t=s("label",{htmlFor:this.inputId||this.uuid,class:this.labelClassNames,onClick:this.onClickLabel.bind(this)},this.label);return s(i,{class:"mx-time-picker block text-3"+(this.error?" error":"")},this.label&&!this.floatLabel&&t,s("div",{ref:t=>this.pickerWrapper=t,class:this.pickerWrapperClass},s("input",Object.assign({"aria-label":this.elAriaLabel||this.label,class:this.inputClass,id:this.inputId||this.uuid,name:this.name,onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onInput:this.onInput.bind(this),ref:t=>this.inputElem=t,tabindex:"0",type:"time",disabled:this.disabled},this.dataAttributes)),this.label&&this.floatLabel&&t,s("button",{type:"button","aria-label":"Open time menu",ref:t=>this.menuButton=t,class:this.menuButtonClass,"data-testid":"menu-button",disabled:this.disabled},s("i",{class:this.error?"mds-warning-circle":"mds-clock"}))),this.assistiveText&&s("div",{class:"caption1 mt-4 ml-16"},s("span",{"data-testid":"assistive-text",class:"assistive-text"},this.assistiveText)),s("mx-menu",{ref:t=>this.menu=t,placement:"bottom",offset:[0,1],onMxClose:this.onMenuClose.bind(this),onMxOpen:this.onMenuOpen.bind(this)},o.map((t=>s("mx-menu-item",{onClick:this.setValue.bind(this,t)},this.getLocalizedTimeString(t))))))}get element(){return e(this)}static get watchers(){return{value:["onValueChange"]}}};export{r as mx_time_picker}